"0","plots_per_file <- 4"
"0","num_files <- ceiling(m1_K / plots_per_file) # 생성될 총 파일 수"
"0","plot_counter_total <- 0 # 전체 플롯 카운터"
"0","stm_label_year<- labelTopics(stm_model_year_14, n = 10)"
"0",""
"0","# 데이터의 연도 범위 미리 계산"
"0","min_year_data <- floor(min(stm_effect_model_year$data$pub.year, na.rm = TRUE))"
"0","max_year_data <- ceiling(max(stm_effect_model_year$data$pub.year, na.rm = TRUE))"
"0",""
"0","for (file_num in 1:num_files) {"
"0","  start_topic_in_file <- (file_num - 1) * plots_per_file + 1"
"0","  end_topic_in_file <- min(file_num * plots_per_file, m1_K)"
"0","  # 파일명은 이전과 동일한 패턴을 유지합니다."
"0","  filename_png <- paste0(""topic_proportions_larger_text_topics(14)_"", start_topic_in_file, ""_to_"", end_topic_in_file, "".png"")"
"0",""
"0","  png(filename = filename_png,"
"0","      width = 18,       # 전체 PNG 너비 유지"
"0","      height = 14,      # 전체 PNG 높이 유지"
"0","      units = ""in"","
"0","      res = 300)"
"0",""
"0","  par(mfrow = c(2, 2))"
"0","  # 각 subplot의 여백: par(mar = c(bottom, left, top, right))"
"0","  # 상단 여백을 제목 크기에 맞춰 더 늘림"
"0","  par(mar = c(4.5, 4.5, 6.0, 2.1)) # 상단 여백 5.0 -> 6.0으로 증가"
"0",""
"0","  for (i in start_topic_in_file:end_topic_in_file) {"
"0","    plot_counter_total <- plot_counter_total + 1"
"0",""
"0","    # 제목에 사용될 키워드 수는 3개로 유지 (필요시 조절)"
"0","    main_title <- paste0('Topic ', i, ': ', paste(stm_label_year$frex[i, 1:5], collapse = "", ""))"
"0",""
"0","    plot(stm_effect_model_year,"
"0","         covariate = ""pub.year"","
"0","         method = ""continuous"","
"0","         topics = i,"
"0","         printlegend = FALSE,"
"0","         main = main_title,"
"0","         xaxt = ""n"","
"0","         cex.main = 1.8,  # 메인 제목 크기 대폭 증가 (예: 1.4 -> 1.8)"
"0","         cex.axis = 1.0,  # 축 눈금 레이블 크기 유지 (이전과 동일)"
"0","         cex.lab = 1.2)   # 축 제목 크기 유지 (이전과 동일)"
"0",""
"0","    tick_years <- pretty(seq(min_year_data, max_year_data, by=1), n=5)"
"0","    axis(1, at = tick_years, labels = tick_years, cex.axis = 1.0) # x축 눈금 크기 유지"
"0",""
"0","  } # 현재 파일 내 토픽 루프 종료"
"0",""
"0","  plots_in_current_file <- end_topic_in_file - start_topic_in_file + 1"
"0","  if (plots_in_current_file < plots_per_file) {"
"0","    for (j in 1:(plots_per_file - plots_in_current_file)) {"
"0","      plot.new() # 빈 플롯으로 채움"
"0","    }"
"0","  }"
"0",""
"0","  dev.off() # 현재 PNG 파일 장치 닫기"
"0","  cat(""제목이 더 커진 플롯 그룹이"", filename_png, ""로 저장되었습니다.\n"")"
"0",""
"0","} # 전체 파일 루프 종료"
"1","제목이 더 커진 플롯 그룹이 topic_proportions_larger_text_topics(14)_1_to_4.png 로 저장되었습니다.
"
"1","제목이 더 커진 플롯 그룹이 topic_proportions_larger_text_topics(14)_5_to_8.png 로 저장되었습니다.
"
"1","제목이 더 커진 플롯 그룹이 topic_proportions_larger_text_topics(14)_9_to_12.png 로 저장되었습니다.
"
"1","제목이 더 커진 플롯 그룹이 topic_proportions_larger_text_topics(14)_13_to_14.png 로 저장되었습니다.
"
"0","# 작업 후 R 기본 플롯 파라미터로 복원 (선택 사항)"
"0","# par(mfrow = c(1, 1))"
"0","# par(mar = c(5.1, 4.1, 4.1, 2.1)) # R 기본값 예시"
"0",""
"0","cat(""모든 2x2 플롯 그룹 (제목 추가 확대) 저장이 완료되었습니다.\n"")"
"1","모든 2x2 플롯 그룹 (제목 추가 확대) 저장이 완료되었습니다.
"
